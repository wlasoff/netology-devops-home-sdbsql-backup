# Домашнее задание к занятию "`Резервное копирование баз данных`" - `Студент группы FOPS-42 Власов Владимир.`


**Домашнее задание выполните в Google Docs или в md-файле в вашем репозитории GitHub.** 

Для оформления вашего решения в GitHub можете воспользоваться [шаблоном](https://github.com/netology-code/sys-pattern-homework).

Название файла должно содержать номер лекции и фамилию студента. Пример названия: «12.8. Резервное копирование баз данных — Александр Александров».

Перед тем как выслать ссылку, убедитесь, что её содержимое не является приватным, то есть открыто на просмотр всем, у кого есть ссылка. Если необходимо прикрепить дополнительные ссылки, просто добавьте их в свой Google Docs.

Любые вопросы задавайте в разделе «Вопросы по заданию» в личном кабинете.

---

### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.
1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.
1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

*Приведите ответ в свободной форме.*

---

## Решение задания 1:

1.1 Сделать полный бэкап 1 раз в неделю, далее каждый день выполнять дифференциальный бэкап.
1.2 Аналогично сделать полный бэкап 1 раз в день, далее потом в течение дня инкрементный.
1.3 Вариант репликации master-slave.
1.3.* 

---

### Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).
2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

Приведите ответ в свободной форме.

## Решение задания 2:

2.1 Базовая команда `pg_dump <имя_базы> > <файл_сохранения>`.
    Команда pg_dump — выгрузить базу данных PostgreSQL в виде скрипта или в архивном формате. После воспользовавшись командой `pg_restore`  восстанавливаем выбранную базу данных
    PostgreSQL. Для указания базы данных нужно задать параметр `-d` - `pg_restore <имя_базы> <файл_сохранения>`.

[Выводы взяты отсюда](https://postgrespro.ru/docs/postgresql/11/app-pgdump)

2.1.* При использовании pg_dump для регулярного резервного копирования каждой базы данных, необходимо создавать отдельные задачи в cron на основе скриптов.
      Восстановление же лучше делать вручную по необхлодимости (повреждение, сбой и т.п.), но возможено создание отдельных задачь в cron с помощью скриптов.

[Выводы взяты отсюда](https://selectel.ru/blog/postgresql-backup-tools/)

---

### Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL.
3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

Приведите ответ в свободной форме.

### Решение задания 3: 

3.1. Для данного вида резеревирования используется команда `mysqlbackup --incremental-base=history:last_full_backup`.

[Выводы взяты отсюда](https://www.rldp.ru/mysql/meb80/backup.htm)

Есть сторонние утилиты, например, Percona XtraBackup, которая позволяет делать архивы баз данных на лету без блокировок таблиц.
Вот команда: `xtrabackup --backup --target-dir=/backupdb/inc1 --incremental-basedir=/backupdb/full`.

[Выводы взяты отсюда](https://serveradmin.ru/polnyj-i-inkrementnyj-backup-mysql/)

3.1.* Нужно соблюсти следущие параметры для развертывания и эксплуатации информационной системы:

      - отказоустойчивость — если основной сервер выходит из строя, резервная копия (реплика) берёт на себя его функции.
      - масштабирование — можно распределить нагрузку: одни серверы обрабатывают записи, другие — чтения.
      - резервное копирование в реальном времени — в отличие от классического бэкапа, репликация поддерживает копии постоянно актуальными.
      - снижение задержек доступа — реплики могут быть географически ближе к пользователям.
      

[Выводы взяты отсюда](https://glabit.ru/blog/replikaciya-baz-dannyh)

---
